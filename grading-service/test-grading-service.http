### ============================================
### GRADING SERVICE API TESTS
### ============================================

### Variables
@baseUrl = http://localhost:8080
@teacherToken = eyJhbGciOiJSUzI1NiJ9.eyJmaXJzdG5hbWUiOiJKb2huIiwicm9sZSI6IlRFQUNIRVIiLCJ0b2tlbl90eXBlIjoiQUNDRVNTX1RPS0VOIiwidXNlcklkIjoiOGQ5N2RlMmEtNDVmYy00NDliLWJmMDEtYmI3ZWM5NmZkOWJlIiwiZW1haWwiOiJ0ZWFjaGVyQHNjaG9vbC5jb20iLCJsYXN0bmFtZSI6IkRvZSIsInN1YiI6InRlYWNoZXJAc2Nob29sLmNvbSIsImlhdCI6MTc2ODUzMTEzMCwiZXhwIjoxNzY4NjE3NTMwfQ.rzLXtzSVAraoBA01ElSy9HiViPkzZQdeO2CfobukGaC6DlTJvixx2ehiWUBc14IEQFesfD3z3CiXUO52N675LihrsyEWigD-SrS1-WPptAeFZR5iw5I8GwpCRVIvv4Dv5iNXxHkp6Bx9TvDXxgrNEyP_35GaEeHMXyfJ3MxTO7AkcdU9qjPwjHr5GkloQ3lDy3RUWgUWZFO_gFpJOGCJ2nR1aereGj7e7yJ_TIftj-FPURTwgWi2KcZ72idR2J00jMBOQMVYbDJy3uH8YgCy8jDuwn2HryPzpFleTWSwqGhfyA2iUIYBt_9TSf0wvGNwkb3ahe6sxHoa2RAGE6bD9A
@studentToken = eyJhbGciOiJSUzI1NiJ9.eyJmaXJzdG5hbWUiOiJBbGljZSIsInJvbGUiOiJTVFVERU5UIiwidG9rZW5fdHlwZSI6IkFDQ0VTU19UT0tFTiIsInVzZXJJZCI6IjhkZjkwNjFiLThmZDctNDQ0Ni05OTZkLTcxOGE0OGM4ZjY3MyIsImVtYWlsIjoic3R1ZGVudEBzY2hvb2wuY29tIiwibGFzdG5hbWUiOiJTbWl0aCIsInN1YiI6InN0dWRlbnRAc2Nob29sLmNvbSIsImlhdCI6MTc2ODUzMTcwMywiZXhwIjoxNzY4NjE4MTAzfQ.NWoBewoe68C5yiC42lW70zWu2mrdkYQI4-EZLvi1d5i1K0oilCf_GRAH0bmxD6Q1jcRXFY4ldbQ9ASKzLLc81L6NKlzkksB2WuSonfU9sns-LQlsXQxa0vioNIUTrsEdDOxvpTgqt7EBnL_ZI0bcihkZFBrgctvYOhggmQMJObvb2Lhra1oGfBcAHSvzHfCWXB9lab-RfjEEL-NOvaHjFp1SbBsRp7gPnz1KzvXPlttqHZibzyz-IAvuV--3WfzqOjg75UGOcmcR51DceSJipZFBsA0C9W4HHC8-nnE3zXdFDfWkx4WsPUIEJs83g5B9UuJZM4md_iOPxJb3B2fYCg
@studentToken2 = eyJhbGciOiJSUzI1NiJ9.eyJmaXJzdG5hbWUiOiJNaWNoYWVsIiwicm9sZSI6IlNUVURFTlQiLCJ0b2tlbl90eXBlIjoiQUNDRVNTX1RPS0VOIiwidXNlcklkIjoiNjdhM2RmMWItYTAwZC00NDZkLWE2MjYtMzljMDk0YWVhMzliIiwiZW1haWwiOiJzdHVkZW50MkBzY2hvb2wuY29tIiwibGFzdG5hbWUiOiJEYW4iLCJzdWIiOiJzdHVkZW50MkBzY2hvb2wuY29tIiwiaWF0IjoxNzY4NTYyMzUzLCJleHAiOjE3Njg2NDg3NTN9.UivwpjEh5MPgnOrGtLU1Yio-7uOmT6TKBONv0_pscKtZe-4tUwT9EV1X3vplwKHOtcpgXJt8YoFdzs-BKSVLVR65FXlNyjtEcoevaMrPtXyMxChhTBUspc_TSbVKoqJKsZbtIdbAQhDOnZqrIwQJORo1AP5WkdXovu6zE3qTZjcYSj8LQ5y7QmyatVZPbttu3zTMWMWnm_W3VKegRv9IVoP6sn0cfNrbkFhTTk5gXoYxuBcl_twDvJCAXsZEq-c_Yd2qoOgqyrPrrwVGc0UM8k9T-n8_JZBdpC7N6EsPr1W918URX-mL9DiWJ8ojWD9EZXeEvQhXY7DBVS6L6BaV3Q
@courseId = 86e3ff3a-8719-4491-adfd-eb2346bb799c
@assignmentId = 5d4c6ffe-8c57-41ef-99c1-c76891c20b6a
@lectureId = 5b371001-d8ec-47db-93c4-52cb3d3c440a
@submissionId = 18c2d452-bc0c-468a-89a0-c762caf08ea0

### ============================================
### SECTION 1: ASSIGNMENT APIS
### ============================================

### 1.1 Create Assignment (TEACHER Only)
POST {{baseUrl}}/api/v1/grading/assignments/create
Authorization: Bearer {{teacherToken}}
Content-Type: application/json

{
  "title": "Midterm Exam - Spring 2026",
  "description": "Complete all questions in the exam paper. Duration: 2 hours",
  "courseId": "{{courseId}}",
  "submissionDate": "2026-02-15 23:59:59"
}

### Expected: 201 Created
### Response:
### {
###   "id": "4558d43c-808b-4547-a8d6-08bccafd8577",
###   "title": "Midterm Exam - Spring 2026",
###   "description": "Complete all questions in the exam paper. Duration: 2 hours",
###   "courseId": "86e3ff3a-8719-4491-adfd-eb2346bb799c",
###   "submissionDate": "2026-02-15T23:59:59",
###   "createdAt": "2026-01-16T10:30:00"
### }
### ðŸ‘‰ Save the assignment ID for later tests


### 1.2 Create Assignment - Validation Error (Missing title)
POST {{baseUrl}}/api/v1/grading/assignments/create
Authorization: Bearer {{teacherToken}}
Content-Type: application/json

{
  "description": "Complete all questions",
  "courseId": "{{courseId}}",
  "submissionDate": "2026-02-15 23:59:59"
}

### Expected: 400 Bad Request
### Response:
### {
###   "code": 1003,
###   "message": "Invalid input",
###   "errors": {
###     "title": "Title is required"
###   }
### }


### 1.3 Update Assignment (TEACHER Only)
PATCH {{baseUrl}}/api/v1/grading/assignments/{{assignmentId}}
Authorization: Bearer {{teacherToken}}
Content-Type: application/json

{
  "title": "Updated: Midterm Exam - Spring 2026",
  "description": "Updated: Complete all questions. Time extended to 3 hours",
  "submissionDate": "2026-02-20 23:59:59"
}

### Expected: 204 No Content
### Assignment updated successfully


### 1.4 Get Assignment Basic Info
GET {{baseUrl}}/api/v1/grading/assignments/{{assignmentId}}/basic
Authorization: Bearer {{teacherToken}}

### Expected: 200 OK
### Response:
### {
###   "id": "6cf5d8bf-34e2-4ee2-8775-b487e75027af",
###   "title": "Updated: Midterm Exam - Spring 2026",
###   "description": "Updated: Complete all questions. Time extended to 3 hours",
###   "submissionDate": "2026-02-20T23:59:59",
###   "createdAt": "2026-01-16T10:30:00"
### }


### 1.5 Get Assignment Full Details
GET {{baseUrl}}/api/v1/grading/assignments/{{assignmentId}}
Authorization: Bearer {{teacherToken}}

### Expected: 200 OK
### Response:
### {
###   "id": "6cf5d8bf-34e2-4ee2-8775-b487e75027af",
###   "title": "Updated: Midterm Exam - Spring 2026",
###   "description": "Updated: Complete all questions. Time extended to 3 hours",
###   "courseId": "86e3ff3a-8719-4491-adfd-eb2346bb799c",
###   "submissionDate": "2026-02-20T23:59:59",
###   "createdAt": "2026-01-16T10:30:00",
###   "submissions": [
###     {
###       "id": "sub-id-1",
###       "studentId": "student-id-1",
###       "status": "ON_TIME",
###       "submittedAt": "2026-02-15T14:30:00"
###     }
###   ]
### }


### 1.6 Get All Assignments by Course ID
GET {{baseUrl}}/api/v1/grading/assignments/course/{{courseId}}
Authorization: Bearer {{teacherToken}}

### Expected: 200 OK
### Response:
### [
###   {
###     "id": "6cf5d8bf-34e2-4ee2-8775-b487e75027af",
###     "title": "Updated: Midterm Exam - Spring 2026",
###     "description": "Updated: Complete all questions. Time extended to 3 hours",
###     "submissionDate": "2026-02-20T23:59:59",
###     "createdAt": "2026-01-16T10:30:00"
###   },
###   {
###     "id": "another-assignment-id",
###     "title": "Final Project - Spring 2026",
###     "description": "Build a complete microservices application",
###     "submissionDate": "2026-05-31T23:59:59",
###     "createdAt": "2026-01-17T09:00:00"
###   }
### ]


### 1.7 Delete Assignment (TEACHER Only)
DELETE {{baseUrl}}/api/v1/grading/assignments/{{assignmentId}}
Authorization: Bearer {{teacherToken}}

### Expected: 204 No Content
### Assignment and all related submissions are permanently deleted


### 1.8 Create Assignment - Unauthorized (STUDENT tries to create)
POST {{baseUrl}}/api/v1/grading/assignments/create
Authorization: Bearer {{studentToken}}
Content-Type: application/json

{
  "title": "Unauthorized Assignment",
  "description": "This should fail",
  "courseId": "{{courseId}}",
  "submissionDate": "2026-02-15 23:59:59"
}

### Expected: 403 Forbidden
### Response:
### {
###   "code": 1002,
###   "message": "Access Denied - Only teachers can create assignments"
### }


### ============================================
### SECTION 2: LECTURE APIS (Multi-File Support)
### ============================================

### 2.1 Create Lecture with Multiple Files (TEACHER Only)
# Note: courseId is in URL path
# Can upload multiple files in one request
POST {{baseUrl}}/api/v1/grading/lectures/course/{{courseId}}
Authorization: Bearer {{teacherToken}}
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="title"

Introduction to Spring Boot
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="description"

This lecture covers the basics of Spring Boot framework
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="files"; filename="lecture_slides.pdf"
Content-Type: application/pdf

< ./security_report.pdf
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="files"; filename="Week4.pdf"
Content-Type: application/zip

< ./Week4.pdf
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### Expected: 201 Created
### Response:
### {
###   "id": "4e5f2d08-286b-485e-a162-b49feed83567",
###   "title": "Introduction to Spring Boot",
###   "description": "This lecture covers the basics of Spring Boot framework",
###   "courseId": "86e3ff3a-8719-4491-adfd-eb2346bb799c",
###   "files": [
###     {
###       "id": "file-uuid-1",
###       "fileName": "lecture_slides.pdf",
###       "fileSize": 2048576,
###       "contentType": "application/pdf",
###       "createdDate": "2026-01-16T11:00:00"
###     },
###     {
###       "id": "file-uuid-2",
###       "fileName": "code_examples.zip",
###       "fileSize": 1024000,
###       "contentType": "application/zip",
###       "createdDate": "2026-01-16T11:00:00"
###     }
###   ],
###   "fileCount": 2,
###   "totalFileSize": 3072576,
###   "uploadedBy": "teacher-id",
###   "createdDate": "2026-01-16T11:00:00",
###   "lastModifiedDate": null
### }
### ðŸ‘‰ Save the lecture ID and file IDs for later tests

@lectureFileId = 273548b8-2a5e-434a-8f5a-8515bcfa851b


### 2.2 Create Lecture without Files (TEACHER Only)
# Files can be added later using add files endpoint
POST {{baseUrl}}/api/v1/grading/lectures/course/{{courseId}}
Authorization: Bearer {{teacherToken}}
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="title"

Spring Data JPA
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="description"

Deep dive into Spring Data JPA
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### Expected: 201 Created with fileCount: 0


### 2.3 Get Lecture Detail by ID (Everyone can access)
GET {{baseUrl}}/api/v1/grading/lectures/{{lectureId}}
Authorization: Bearer {{studentToken}}

### Expected: 200 OK
### Response:
### {
###   "id": "4e5f2d08-286b-485e-a162-b49feed83567",
###   "title": "Introduction to Spring Boot",
###   "description": "This lecture covers the basics of Spring Boot framework",
###   "courseId": "86e3ff3a-8719-4491-adfd-eb2346bb799c",
###   "files": [
###     {
###       "id": "file-uuid-1",
###       "fileName": "lecture_slides.pdf",
###       "fileSize": 2048576,
###       "contentType": "application/pdf",
###       "createdDate": "2026-01-16T11:00:00"
###     }
###   ],
###   "fileCount": 1,
###   "totalFileSize": 2048576,
###   "uploadedBy": "teacher-id",
###   "createdDate": "2026-01-16T11:00:00"
### }


### 2.4 Get All Lectures by Course ID (Everyone can access)
# Returns only id and title for listing
GET {{baseUrl}}/api/v1/grading/lectures/course/{{courseId}}
Authorization: Bearer {{studentToken}}

### Expected: 200 OK
### Response:
### [
###   {
###     "id": "4e5f2d08-286b-485e-a162-b49feed83567",
###     "title": "Introduction to Spring Boot"
###   },
###   {
###     "id": "5f6g3e09-397c-596f-b273-c50gffe94678",
###     "title": "Spring Data JPA"
###   }
### ]


### 2.5 Download Specific Lecture File (Everyone can access)
# Download by file ID (not lecture ID)
GET {{baseUrl}}/api/v1/grading/lectures/files/{{lectureFileId}}/download
Authorization: Bearer {{studentToken}}

### Expected: 200 OK
### Content-Type: application/pdf (or appropriate file type)
### Content-Disposition: attachment; filename="lecture_slides.pdf"
### File content is returned as binary stream


### 2.6 Add Files to Existing Lecture (TEACHER Only)
# Add more files to an existing lecture
POST {{baseUrl}}/api/v1/grading/lectures/{{lectureId}}/files
Authorization: Bearer {{teacherToken}}
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="files"; filename="additional_notes.pdf"
Content-Type: application/pdf

< ./security_report.pdf
------WebKitFormBoundary7MA4YWxkTrZu0gW
#Content-Disposition: form-data; name="files"; filename="homework.docx"
#Content-Type: application/vnd.openxmlformats-officedocument.wordprocessingml.document
#
#< ./Week4.pdf
#------WebKitFormBoundary7MA4YWxkTrZu0gW--

### Expected: 200 OK
### Response: Updated LectureResponse with new files added


### 2.7 Delete Specific File from Lecture (TEACHER Only)
# Delete individual file from lecture
DELETE {{baseUrl}}/api/v1/grading/lectures/{{lectureId}}/files/{{lectureFileId}}
Authorization: Bearer {{teacherToken}}

### Expected: 200 OK
### Response: Updated LectureResponse without the deleted file


### 2.8 Update Lecture Info Only (TEACHER Only)
# Update title and/or description (not files)
PATCH {{baseUrl}}/api/v1/grading/lectures/{{lectureId}}
Authorization: Bearer {{teacherToken}}
Content-Type: application/json

{
  "title": "Updated: Introduction to Spring Boot",
  "description": "Updated description with additional content"
}

### Expected: 200 OK
### Response:
### {
###   "id": "4e5f2d08-286b-485e-a162-b49feed83567",
###   "title": "Updated: Introduction to Spring Boot",
###   "description": "Updated description with additional content",
###   ...
### }


### 2.9 Update Lecture - Title Only (TEACHER Only)
PATCH {{baseUrl}}/api/v1/grading/lectures/{{lectureId}}
Authorization: Bearer {{teacherToken}}
Content-Type: application/json

{
  "title": "Spring Boot Fundamentals"
}

### Expected: 200 OK


### 2.10 Delete Lecture and All Files (TEACHER Only)
DELETE {{baseUrl}}/api/v1/grading/lectures/{{lectureId}}
Authorization: Bearer {{teacherToken}}

### Expected: 204 No Content
### Lecture and ALL associated files are permanently deleted


### ============================================
### ERROR CASES - LECTURE
### ============================================

### 2.11 Create Lecture - Unauthorized (STUDENT tries to create)
POST {{baseUrl}}/api/v1/grading/lectures/course/{{courseId}}
Authorization: Bearer {{studentToken}}
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="title"

Unauthorized Lecture
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### Expected: 403 Forbidden


### 2.12 Add Files - Unauthorized (STUDENT tries to add files)
POST {{baseUrl}}/api/v1/grading/lectures/{{lectureId}}/files
Authorization: Bearer {{studentToken}}
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="files"; filename="hack.pdf"
Content-Type: application/pdf

< ./security_report.pdf
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### Expected: 403 Forbidden


### 2.13 Update Lecture - Unauthorized (STUDENT tries to update)
PATCH {{baseUrl}}/api/v1/grading/lectures/{{lectureId}}
Authorization: Bearer {{studentToken}}
Content-Type: application/json

{
  "title": "Hacked Title"
}

### Expected: 403 Forbidden


### 2.14 Delete Lecture - Unauthorized (STUDENT tries to delete)
DELETE {{baseUrl}}/api/v1/grading/lectures/{{lectureId}}
Authorization: Bearer {{studentToken}}

### Expected: 403 Forbidden


### 2.15 Delete File - Unauthorized (STUDENT tries to delete file)
DELETE {{baseUrl}}/api/v1/grading/lectures/{{lectureId}}/files/{{lectureFileId}}
Authorization: Bearer {{studentToken}}

### Expected: 403 Forbidden


### 2.16 Get Lecture - Not Found
GET {{baseUrl}}/api/v1/grading/lectures/non-existent-id
Authorization: Bearer {{teacherToken}}

### Expected: 404 Not Found
### Response:
### {
###   "code": "LECTURE_NOT_FOUND",
###   "message": "Lecture not found with id: non-existent-id"
### }


### 2.17 Download File - Not Found
GET {{baseUrl}}/api/v1/grading/lectures/files/non-existent-file-id/download
Authorization: Bearer {{studentToken}}

### Expected: 404 Not Found
### Response:
### {
###   "code": "LECTURE_FILE_NOT_FOUND",
###   "message": "Lecture file not found with id: non-existent-file-id"
### }


### ============================================
### SECTION 3: ASSIGNMENT + SUBMISSION APIS (MERGED)
### ============================================
### Note: Submission APIs are now part of Assignment APIs

### 3.1 Submit Assignment (STUDENT Only)
# Endpoint: POST /api/v1/grading/assignments/{assignmentId}/submit
POST {{baseUrl}}/api/v1/grading/assignments/{{assignmentId}}/submit
Authorization: Bearer {{studentToken2}}
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="file"; filename="security_report.pdf"
Content-Type: application/pdf

< ./security_report.pdf
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### Expected: 201 Created
### Response:
### {
###   "id": "submission-id-789",
###   "assignmentId": "6cf5d8bf-34e2-4ee2-8775-b487e75027af",
###   "studentId": "8df9061b-8fd7-4446-996d-718a48c8f673",
###   "fileName": "my-assignment.pdf",
###   "fileSize": 1024000,
###   "contentType": "application/pdf",
###   "submittedDate": "2026-01-16 15:30:00",
###   "status": "SUBMITTED",
###   "grade": null,
###   "feedback": null,
###   "createdDate": "2026-01-16 15:30:00",
###   "lastModifiedDate": 2026-01-16 15:30:00
### }
### ðŸ‘‰ Save the submission ID for later tests


### 3.2 Resubmit Assignment (replaces previous submission)
POST {{baseUrl}}/api/v1/grading/assignments/{{assignmentId}}/submit
Authorization: Bearer {{studentToken}}
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="file"; filename="my-assignment-v2.pdf"
Content-Type: application/pdf

< ./Week4.pdf
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### Expected: 201 Created (updates existing submission)
### Response:
### {
###   "id": "submission-id-789",
###   "fileName": "my-assignment-v2.pdf",
###   "submittedDate": "2026-01-16T16:45:00",
###   "lastModifiedDate": "2026-01-16T16:45:00",
###   ...
### }


### 3.3 Get Assignment Details - As STUDENT (returns my_submission if submitted)
GET {{baseUrl}}/api/v1/grading/assignments/{{assignmentId}}
Authorization: Bearer {{studentToken}}

### Expected: 200 OK
### Response (STUDENT view):
### {
###   "assignment_id": "6cf5d8bf-34e2-4ee2-8775-b487e75027af",
###   "assignment_title": "Midterm Exam - Spring 2026",
###   "assignment_description": "Complete all questions...",
###   "course_id": "86e3ff3a-8719-4491-adfd-eb2346bb799c",
###   "submission_date": "2026-02-20 23:59:59",
###   "create_by": "8d97de2a-45fc-449b-bf01-bb7ec96fd9be",
###   "created_date": "2026-01-16 10:30:00",
###   "my_submission": {
###     "id": "submission-id-789",
###     "fileName": "my-assignment-v2.pdf",
###     "submittedDate": "2026-01-16T16:45:00",
###     "status": "SUBMITTED",
###     ...
###   }
### }
### Note: "submissions" field is NOT included for students


### 3.4 Get Assignment Details - As TEACHER (returns all submissions)
GET {{baseUrl}}/api/v1/grading/assignments/{{assignmentId}}
Authorization: Bearer {{teacherToken}}

### Expected: 200 OK
### Response (TEACHER view):
### {
###   "assignment_id": "6cf5d8bf-34e2-4ee2-8775-b487e75027af",
###   "assignment_title": "Midterm Exam - Spring 2026",
###   "assignment_description": "Complete all questions...",
###   "course_id": "86e3ff3a-8719-4491-adfd-eb2346bb799c",
###   "submission_date": "2026-02-20 23:59:59",
###   "submissions": [
###     {
###       "id": "submission-id-789",
###       "studentId": "8df9061b-8fd7-4446-996d-718a48c8f673",
###       "fileName": "my-assignment-v2.pdf",
###       "status": "SUBMITTED",
###       ...
###     },
###     {
###       "id": "submission-id-790",
###       "studentId": "another-student-id",
###       "fileName": "assignment.pdf",
###       "status": "LATE",
###       ...
###     }
###   ]
### }
### Note: "my_submission" field is NOT included for teachers


### 3.5 Download Submission File
GET {{baseUrl}}/api/v1/grading/assignments/submissions/{{submissionId}}/download
Authorization: Bearer {{teacherToken}}

### Expected: 200 OK
### Content-Type: application/pdf (or appropriate file type)
### Content-Disposition: attachment; filename="my-assignment-v2.pdf"
### File content is returned as binary stream


### 3.6 Delete Submission - STUDENT deletes their own
DELETE {{baseUrl}}/api/v1/grading/assignments/submissions/{{submissionId}}
Authorization: Bearer {{studentToken2}}

### Expected: 204 No Content
### Student can only delete their own submission


### 3.7 Delete Submission - TEACHER deletes any submission
DELETE {{baseUrl}}/api/v1/grading/assignments/submissions/{{submissionId}}
Authorization: Bearer {{teacherToken}}

### Expected: 204 No Content
### Teacher can delete any submission


### 3.8 Delete Submission - STUDENT tries to delete another student's submission
# Note: This requires a submission ID from another student
DELETE {{baseUrl}}/api/v1/grading/assignments/submissions/other-student-submission-id
Authorization: Bearer {{studentToken}}

### Expected: 403 Forbidden
### Response:
### {
###   "code": "SUBMISSION_ACCESS_DENIED",
###   "message": "You do not have permission to delete this submission: other-student-submission-id"
### }


### 3.9 Submit Assignment - Unauthorized (TEACHER tries to submit)
POST {{baseUrl}}/api/v1/grading/assignments/{{assignmentId}}/submit
Authorization: Bearer {{teacherToken}}
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="file"; filename="assignment.pdf"
Content-Type: application/pdf

< ./security_report.pdf
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### Expected: 403 Forbidden
### Response:
### {
###   "code": 1002,
###   "message": "Access Denied - Only students can submit assignments"
### }


### 3.10 Get Assignment with no submission - As STUDENT
# Note: Use an assignment ID where student hasn't submitted yet
GET {{baseUrl}}/api/v1/grading/assignments/{{assignmentId}}
Authorization: Bearer {{studentToken}}

### Expected: 200 OK
### Response:
### {
###   "assignment_id": "...",
###   "assignment_title": "...",
###   "my_submission": null
### }


### ============================================
### SECTION 4: INTEGRATION TESTS
### ============================================

### 4.1 Complete Workflow - Teacher creates assignment
POST {{baseUrl}}/api/v1/grading/assignments/create
Authorization: Bearer {{teacherToken}}
Content-Type: application/json

{
  "title": "Final Project - Spring 2026",
  "description": "Build a complete microservices application",
  "courseId": "{{courseId}}",
  "submissionDate": "2026-05-31 23:59:59"
}

### Expected: 201 Created
### ðŸ‘‰ Copy the assignment ID from response


### 4.2 Teacher uploads lecture for the course
POST {{baseUrl}}/api/v1/grading/lectures/course/{{courseId}}
Authorization: Bearer {{teacherToken}}
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="title"

Project Guidelines
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="description"

Guidelines for the final project
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="files"; filename="guidelines.pdf"
Content-Type: application/pdf

< ./test-files/guidelines.pdf
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### Expected: 201 Created
### ðŸ‘‰ Copy the lecture ID and file ID from response


### 4.3 Student downloads lecture file
# Note: Use fileId from lecture response, not lectureId
GET {{baseUrl}}/api/v1/grading/lectures/files/{{lectureFileId}}/download
Authorization: Bearer {{studentToken}}

### Expected: 200 OK - File downloaded successfully


### 4.4 Student submits assignment
POST {{baseUrl}}/api/v1/grading/assignments/{{assignmentId}}/submit
Authorization: Bearer {{studentToken}}
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="file"; filename="final-project.zip"
Content-Type: application/zip

< ./test-files/final-project.zip
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### Expected: 201 Created
### ðŸ‘‰ Copy the submission ID from response


### 4.5 Teacher views assignment with all submissions
# Note: Use assignment endpoint to get all submissions (as TEACHER)
GET {{baseUrl}}/api/v1/grading/assignments/{{assignmentId}}
Authorization: Bearer {{teacherToken}}

### Expected: 200 OK - Returns assignment with all student submissions


### 4.6 Teacher downloads student submission
GET {{baseUrl}}/api/v1/grading/assignments/submissions/{{submissionId}}/download
Authorization: Bearer {{teacherToken}}

### Expected: 200 OK - File downloaded successfully


### ============================================
### SECTION 5: ERROR SCENARIOS
### ============================================

### 5.1 Get Non-existent Assignment
GET {{baseUrl}}/api/v1/grading/assignments/non-existent-id
Authorization: Bearer {{teacherToken}}

### Expected: 404 Not Found
### Response:
### {
###   "code": 1004,
###   "message": "Assignment not found with ID: non-existent-id"
### }


### 5.2 Get Non-existent Lecture
GET {{baseUrl}}/api/v1/grading/lectures/non-existent-id
Authorization: Bearer {{teacherToken}}

### Expected: 404 Not Found
### Response:
### {
###   "code": 1004,
###   "message": "Lecture not found with ID: non-existent-id"
### }


### 5.3 Download Non-existent Submission
GET {{baseUrl}}/api/v1/grading/assignments/submissions/non-existent-id/download
Authorization: Bearer {{teacherToken}}

### Expected: 404 Not Found
### Response:
### {
###   "code": 1004,
###   "message": "Submission not found with ID: non-existent-id"
### }


### 5.4 Submit without file
POST {{baseUrl}}/api/v1/grading/assignments/{{assignmentId}}/submit
Authorization: Bearer {{studentToken}}
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="file"; filename=""
Content-Type: application/pdf


------WebKitFormBoundary7MA4YWxkTrZu0gW--

### Expected: 400 Bad Request
### Response:
### {
###   "code": 2001,
###   "message": "File is required for submission"
### }


### 5.5 Create lecture without file (Now allowed - files are optional)
POST {{baseUrl}}/api/v1/grading/lectures/course/{{courseId}}
Authorization: Bearer {{teacherToken}}
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="title"

Lecture without file
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="description"

This lecture has no files yet
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### Expected: 201 Created
### Response: Lecture created with fileCount: 0
### Note: Files can be added later using POST /{lectureId}/files


### ============================================
### SECTION 6: FILE TYPE VALIDATION TESTS
### ============================================

### 6.1 Upload Invalid File Type - TXT file (Should FAIL)
POST {{baseUrl}}/api/v1/grading/lectures/course/{{courseId}}
Authorization: Bearer {{teacherToken}}
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="title"

Invalid File Type Test
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="files"; filename="test.txt"
Content-Type: text/plain

This is a text file and should be rejected.
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### Expected: 400 Bad Request
### Response:
### {
###   "code": 2002,
###   "message": "Invalid file type. Allowed types: PDF, PPT, PPTX, DOC, DOCX, XLS, XLSX, ZIP, RAR"
### }


### 6.2 Upload Invalid File Type - JPG image (Should FAIL)
POST {{baseUrl}}/api/v1/grading/lectures/course/{{courseId}}
Authorization: Bearer {{teacherToken}}
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="title"

Invalid Image File
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="files"; filename="image.jpg"
Content-Type: image/jpeg

< ./test-files/image.jpg
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### Expected: 400 Bad Request
### Response:
### {
###   "code": 2002,
###   "message": "Invalid file type. Allowed types: PDF, PPT, PPTX, DOC, DOCX, XLS, XLSX, ZIP, RAR"
### }


### 6.3 Upload Valid PDF File (Should PASS)
POST {{baseUrl}}/api/v1/grading/lectures/course/{{courseId}}
Authorization: Bearer {{teacherToken}}
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="title"

Valid PDF Lecture
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="files"; filename="lecture.pdf"
Content-Type: application/pdf

< ./test-files/lecture.pdf
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### Expected: 201 Created
### Lecture uploaded successfully


### 6.4 Upload Valid PowerPoint File (Should PASS)
POST {{baseUrl}}/api/v1/grading/lectures/course/{{courseId}}
Authorization: Bearer {{teacherToken}}
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="title"

PowerPoint Lecture
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="files"; filename="presentation.pptx"
Content-Type: application/vnd.openxmlformats-officedocument.presentationml.presentation

< ./test-files/presentation.pptx
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### Expected: 201 Created
### PowerPoint file uploaded successfully


### 6.5 Upload Valid Word Document (Should PASS)
POST {{baseUrl}}/api/v1/grading/lectures/course/{{courseId}}
Authorization: Bearer {{teacherToken}}
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="title"

Word Document Lecture
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="files"; filename="document.docx"
Content-Type: application/vnd.openxmlformats-officedocument.wordprocessingml.document

< ./test-files/document.docx
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### Expected: 201 Created
### Word document uploaded successfully


### 6.6 Upload Valid Excel File (Should PASS)
POST {{baseUrl}}/api/v1/grading/lectures/course/{{courseId}}
Authorization: Bearer {{teacherToken}}
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="title"

Excel Spreadsheet
------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="files"; filename="data.xlsx"
Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet

< ./test-files/data.xlsx
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### Expected: 201 Created
### Excel file uploaded successfully


### 6.7 Submit Valid ZIP Assignment (Should PASS)
POST {{baseUrl}}/api/v1/grading/assignments/{{assignmentId}}/submit
Authorization: Bearer {{studentToken}}
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="file"; filename="assignment-project.zip"
Content-Type: application/zip

< ./test-files/assignment-project.zip
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### Expected: 201 Created
### ZIP file submitted successfully


### 6.8 Submit Valid RAR Assignment (Should PASS)
POST {{baseUrl}}/api/v1/grading/assignments/{{assignmentId}}/submit
Authorization: Bearer {{studentToken}}
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

------WebKitFormBoundary7MA4YWxkTrZu0gW
Content-Disposition: form-data; name="file"; filename="assignment-project.rar"
Content-Type: application/x-rar-compressed

< ./test-files/assignment-project.rar
------WebKitFormBoundary7MA4YWxkTrZu0gW--

### Expected: 201 Created
### RAR file submitted successfully


### ============================================
### TEST SUMMARY CHECKLIST
### ============================================
###
### âœ… Assignment APIs
###    - [ ] Create assignment (teacher only)
###    - [ ] Validation errors
###    - [ ] Update assignment
###    - [ ] Get assignment basic info
###    - [ ] Get assignment full details
###    - [ ] Get assignments by course
###    - [ ] Delete assignment
###    - [ ] Unauthorized access tests
###
### âœ… Lecture APIs
###    - [ ] Upload lecture (teacher only)
###    - [ ] Get lecture by ID
###    - [ ] Get lectures by course
###    - [ ] Download lecture file
###    - [ ] Update lecture metadata
###    - [ ] Delete lecture
###    - [ ] Unauthorized access tests
###
### âœ… Submission APIs
###    - [ ] Submit assignment (student only)
###    - [ ] Resubmit assignment
###    - [ ] Get submission by ID
###    - [ ] Get submissions by assignment
###    - [ ] Get my submissions
###    - [ ] Download submission file
###    - [ ] Delete submission
###    - [ ] Unauthorized access tests
###
### âœ… Integration Tests
###    - [ ] Complete workflow: create â†’ upload â†’ submit
###    - [ ] Teacher and student interaction flow
###
### âœ… Error Scenarios
###    - [ ] Non-existent resources
###    - [ ] Missing required files
###    - [ ] Invalid file types
###
### âœ… File Type Validation
###    - [ ] Invalid file types (txt, jpg)
###    - [ ] Valid file types (pdf, pptx, docx, xlsx, zip, rar)

### ============================================
### NOTES
### ============================================
# 1. Replace variables at the top with actual values
# 2. For file uploads, create a 'test-files' directory in the same location
# 3. Use REST Client extension in VS Code to run these tests
# 4. Test in order: Assignments â†’ Lectures â†’ Submissions
# 5. After creating resources, copy their IDs to variables
# 6. Student submissions automatically check deadlines
# 7. Late submissions are marked with status "LATE"
# 8. Maximum file size: 10MB
# 9. Allowed file types: PDF, PPT, PPTX, DOC, DOCX, XLS, XLSX, ZIP, RAR
# 10. Invalid file types (txt, jpg, png, mp4, etc.) will be rejected
